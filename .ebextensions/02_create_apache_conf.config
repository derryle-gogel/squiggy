#
# Apache configuration files and keys.
#
files:
  /tmp/ssl.conf:
    mode: '000644'
    owner: root
    group: root
    content: |
      <VirtualHost *:443>
        # Required for socket.io's polling transport
        RewriteEngine on
        RewriteCond %{QUERY_STRING}        transport=websocket
        RewriteRule /(.*)$                 ws://localhost:2000/$1 [P]

        # Proxy websocket connections
        ProxyPass         /socket.io/   ws://localhost:8000/socket.io/
        ProxyPassReverse  /socket.io/   ws://localhost:8000/socket.io/
      </VirtualHost>
